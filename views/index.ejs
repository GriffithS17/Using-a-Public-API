<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malware Analysis</title>
    <link rel="stylesheet" href="/bootstrap/bootstrap.css">
    <link rel="stylesheet" href="/style.css">
  </head>
  <body>
    <div class="container">
      <div class="px-4 py-5 my-5 text-center">
        <img
          class="d-block mx-auto mb-4"
          src="/images/bug.png"
          alt=""
          width="120"
          height="120"
        >

        <h1 class="display-5 fw-bold text-body-emphasis">
          Insert a website link
        </h1>

        <form action="/upload" method="post">
          <div>
            <input class="form-control customMargin" type="text" id="link" name="link">
          </div>

          <div class="col-lg-6 mx-auto">

            <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
              <button
                type="submit"
                class="btn btn-success btn-lg px-4 gap-3"
              >
                Submit
              </button>

              <button 
                type="reset"
                class="btn btn-outline-danger btn-lg px-4"
              >
                Clear
              </button>
            </div>
          </div>
        </form>

        <% if(showResults) { %>

        <h1 class="fs-1 mt-5"><%= name %></h1>

        <hr class="mt-5">

        <h1 class="mt-2 mb-3 text-align-left">Votes:</h1>

        <p class="text-success fs-4">Harmless: <%= harmless %></p>
        <p class="text-danger fs-4">Malicious: <%= malicious %></p>

        <hr class="mt-4">

        <table class="table mt-4">
          <% Object.keys(vendor).forEach(engine => { %>
          <tr>
            <td><%= engine %></td>
            <td>
              <% 
                let color = 'text-light'
                let result = vendor[engine].result
                
                if(result == 'clean'){
                  color = 'text-success'
                } 
                else if (result == 'suspicious'){
                  color = 'text-warning'                 
                }
                else if (result == 'unrated' || result == 'undetected' || result == 'timeout'){
                  color = 'text-light'                 
                }
                else {
                  color = 'text-danger'
                }
              %>
              
              <span class="<%= color %>"><%= vendor[engine].result %></span>
            </td>
          </tr>
          <% }) %>
        </table> 

        <% } %>
      </div>
    </div>

    <script src="../index.js"></script>
    <script src="/bootstrap/bootstrap.js"></script>
  </body>
</html>
